---
title: Malware Detection
subtitle: Aprendizagem Aplicada à Segurança
author: Mário Antunes
institute: Universidade de Aveiro
date: November 28, 2025
colorlinks: true
highlight-style: tango
geometry: a4paper,margin=2cm
mainfont: NotoSans
mainfontfallback:
  - "NotoColorEmoji:mode=harf"
header-includes:
 - \usepackage{longtable,booktabs}
 - \usepackage{etoolbox}
 - \AtBeginEnvironment{longtable}{\normalsize}
 - \AtBeginEnvironment{cslreferences}{\tiny}
 - \AtBeginEnvironment{Shaded}{\normalsize}
 - \AtBeginEnvironment{verbatim}{\normalsize}
 - \setmonofont[Contextuals={Alternate}]{FiraCodeNerdFontMono-Retina}
---

# Malware Classification using Dynamic and Hybrid Features

## Objective

In this lab, you will explore two different approaches to malware detection using Machine Learning. You will move from analyzing how a program behaves (Dynamic Analysis) to a more complex view that combines behavior with file structure (Hybrid Analysis).

## Part 1: Post-Execution Analysis (Dynamic)

### Dataset:

[API Call Sequences (Kaggle)](https://www.kaggle.com/datasets/ang3loliveira/malware-analysis-datasets-api-call-sequences)

### Concept

Dynamic analysis involves running the malware in a secure sandbox (like Cuckoo Sandbox) and recording what it does. The most common "behavioral signature" is the sequence of API calls (e.g., CreateFile, RegOpenKey, SocketConnect).

### Your Task

1. Load the Dataset: Import the API Call dataset.
2. Explore the Data:
    * Look at the api_calls column. Notice how it is a sequence of text strings?
    * Machine Learning models need numbers, not strings.
3. Preprocessing Challenge:
    * You need to convert these text sequences into numerical data.
    * Hint: Look into Label Encoding (assigning a number to every unique API name) or TF-IDF (counting frequency).
4. Modeling:
    * Train a model to predict the malware family (or binary classification).
    *    Since this is sequential data (Time Series), simple models like Random Forest work, but models like LSTMs (Long Short-Term Memory) or GRUs are theoretically better.

## Part 2: Hybrid Analysis (Static + Dynamic)

### Dataset:

[Malware Static and Dynamic Features (UCI)](https://archive.ics.uci.edu/dataset/541/malware+static+and+dynamic+features+vxheaven+and+virus+total)

### Concept

Static analysis looks at the file on the disk (PE Headers, file size, imports) without running it. Dynamic analysis looks at execution. A Hybrid model uses both to cover the weaknesses of each approach.

### Your Task

1. Load the Dataset: Import the UCI dataset.
2. Compare Features:
    * Identify which columns are Static (usually starting with check_sum, section_, or header_).
    * Identify which columns are Dynamic (usually specific API names or counts).
3. Correlation Analysis:
    *   Do static features correlate with dynamic features?
4. Modeling:
    * Train a Classifier (e.g., Random Forest or XGBoost) using all features.
    * Experiment: Try training a model using only static features, then only dynamic features. Compare the accuracy to the combined model.